"use strict";(()=>{var e={};e.id=48;e.ids=[48];e.modules={3402:e=>{e.exports=require("@atproto/api")},3480:(e,r,t)=>{if(false){}else{if(false){}else{if(false){}else{e.exports=t(5600)}}}},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{var t;t={value:true};Object.defineProperty(r,"M",{enumerable:true,get:function(){return s}});function s(e,r){if(r in e){return e[r]}if("then"in e&&typeof e.then==="function"){return e.then(e=>s(e,r))}if(typeof e==="function"&&r==="default"){return e}return undefined}},8667:(e,r)=>{var t;t={value:true};Object.defineProperty(r,"A",{enumerable:true,get:function(){return s}});var s=function(e){e["PAGES"]="PAGES";e["PAGES_API"]="PAGES_API";e["APP_PAGE"]="APP_PAGE";e["APP_ROUTE"]="APP_ROUTE";e["IMAGE"]="IMAGE";return e}({})},9790:(e,r,t)=>{t.r(r);t.d(r,{config:()=>d,"default":()=>l,routeModule:()=>c});var s={};t.r(s);t.d(s,{"default":()=>u});var a=t(3480);var n=t(8667);var o=t(6435);var i=t(3402);async function u(e,r){if(e.method!=="POST"){return r.status(405).json({error:"Method not allowed"})}const{identifier:t,appPassword:s}=e.body;if(!t||!s){return r.status(400).json({error:"Missing credentials"})}console.log("Login attempt with identifier:",t);console.log("App password length:",s.length);console.log("App password format check:",s.includes("-"));const a=new i.BskyAgent({service:"https://bsky.social"});try{const e=await a.login({identifier:t,password:s});let n="";try{const e=await a.api.app.bsky.actor.getProfile({actor:t});n=e.data.avatar||""}catch(e){n=""}r.status(200).json({success:true,session:e.data,avatarUrl:n})}catch(t){console.error("Login failed:",t);console.error("Error details:",{message:t.message,error:t.error,status:t.status,headers:t.headers});let e="Login failed";if(t.error==="AuthenticationRequired"){e="Invalid identifier or app password. Please check your credentials."}else if(t.status===401){e="Authentication failed. Please verify your username and app password."}else if(t.message){e=t.message}r.status(500).json({success:false,error:e,details:{error:t.error,status:t.status}})}};const l=(0,o.M)(s,"default");const d=(0,o.M)(s,"config");const c=new a.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/bluesky/login",pathname:"/api/bluesky/login",bundlePath:"",filename:""},userland:s})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e);var s=t(9790);module.exports=s})();